<!doctype html>
<html>
<head>
<title>Metamap Coordinate Calculator</title>
<!-- 
PUBLIC DOMAIN, NO COPYRIGHTS, NO PATENTS.

NO MONEY
NO MINING
NO PROPERTY
EVERYTHING IS RECURSIVE
EVERYTHING IS FRACTAL
EVERYTHING IS PHYSICAL
[EGO DEATH]:
    LOOK TO THE FUNGI
    LOOK TO THE INSECTS
    LANGUAGE IS HOW THE MIND PARSES REALITY
-->

<script id = "topfunctions">

function latlon2xy(latlonin){
//Washington Monument is at 38.8895,-77.0352 and is 555 feet high
    var lat0 = 38.8895;
    var coslat = Math.cos(lat0*Math.PI/180);//convert to radians, take cos of lattitude
    var lon0 = -77.0352;
    var unitfeet = 555;
    
    var digits = 1;
    var precision = Math.pow(10,digits);
    
    var lat1 = parseFloat(latlonin.split(",")[0]);
    var lon1 = parseFloat(latlonin.split(",")[1]);
    //from the original definition of the meter:
    //90 degrees lattitude = 10,000,000 meters = 32808399 feet
    //1 degree lattitude = 32808399/90 = 364538 feet
    //1 degree longitude = 1 degre lattitude X cos(lattitude) = 283699 feet.
    deltaxfeet = Math.round((lon1 - lon0)*364538*coslat);
    deltayfeet = Math.round((lat1 - lat0)*364538);
    return (Math.round(precision*deltaxfeet/unitfeet)/precision).toString() + "," + (Math.round(precision*deltayfeet/unitfeet)/precision).toString();
}

function xy2latlon(wmin){
//Washington Monument is at 38.8895,-77.0352 and is 555 feet high
    var lat0 = 38.8895;
    var coslat = Math.cos(lat0*Math.PI/180);//convert to radians, take cos of lattitude
    var lon0 = -77.0352;
    var unitfeet = 555;
    
    var digits = 4;
    var precision = Math.pow(10,digits);

    var x = parseFloat(wmin.split(",")[0]);
    var y = parseFloat(wmin.split(",")[1]);

    deltaxfeet = x*unitfeet;
    deltayfeet = y*unitfeet;

    //from the original definition of the meter:
    //90 degrees lattitude = 10,000,000 meters = 32808399 feet
    //1 degree lattitude = 32808399/90 = 364538 feet
    //1 degree longitude = 1 degre lattitude X cos(lattitude) = 283699 feet.

    lat1 = Math.round(precision*(lat0 + deltayfeet/364538))/precision;
    lon1 = Math.round(precision*(lon0 + deltaxfeet/(364538*coslat)))/precision;
    return lat1.toString() + "," + lon1.toString();
    
}

</script>


<body>
<div id = "page">
    <a  id = "editlink" href = "editor.php">Editor</a>
    <div class = "bigbox">
        Lattitude,Longitude:
        <input id = "latloninput" value = "38.8895,-77.0352"/>
    </div>
    <div class = "bigbox">
        x,y[Washington Monuments]:
        <input id = "wminput" value = "0,0"/>
    </div>

    <img width = "30%" src = "images/fig1.png"/>
    <img width = "65%" src = "images/fig2.png"/>
</div>
<script id = "pageevents">
document.getElementById("latloninput").onchange = function(){
    document.getElementById("wminput").value = latlon2xy(this.value);
}

document.getElementById("wminput").onchange = function(){
    document.getElementById("latloninput").value = xy2latlon(this.value);
}
</script>
<style>

#editlink{
     position:absolute;
     left:50%;
     top:10px;
     z-index:2;
}

.bigbox{
    border:solid;
    border-radius:1em;
    font-size:16px;
    font-family:courier;
    text-align:center;
    margin:0.5em 0.5em 0.5em 0.5em;
    padding:1em 1em 1em 1em;
}
.bigbox input{
    font-size:16px;
    font-family:courier;
    display:block;
    margin:auto;
    width:80%;
    margin-top:0.2em;
}
</style>
</body>
</html>

